import{aD as C,d as D,u as p,r as d,j as e,B as A,e as i,f as B,h as J,i as f,ao as P,k,a2 as I,O as L}from"./index-CNxWMcuV.js";import{g as S}from"./jobTranslation-C42sppDK.js";import{A as T}from"./arrow-left-5j_RihUX.js";import{C as E}from"./car-DWakAuoX.js";import{C as V}from"./circle-check-big-a_8kXWWc.js";import"./googleTranslate-BIF2yF35.js";function _({status:s}){const{t:l}=p(),t={not_started:{class:"status-not-started",label:l("jobs.notStarted")},in_progress:{class:"status-in-progress",label:l("jobs.inProgress")},waiting_for_parts:{class:"status-waiting",label:l("jobs.waitingParts")},completed:{class:"status-completed",label:l("jobs.completed")}},{class:c,label:r}=t[s];return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${c}`,children:r})}function R(){const{vehicleId:s}=C(),l=D(),{t,language:c}=p(),[r,g]=d.useState(null),[n,j]=d.useState([]),[N,o]=d.useState(!0);if(d.useEffect(()=>{(async()=>{if(!s){o(!1);return}o(!0);try{const[h,v]=await Promise.all([k(s),I(s)]);g(h);const b=v.sort((y,w)=>new Date(w.createdAt).getTime()-new Date(y.createdAt).getTime());j(b)}catch(h){console.error("Error loading vehicle history:",h)}finally{o(!1)}})()},[s]),N)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:t("common.loading")})});if(!r)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:t("common.noData")})});const m=n.filter(a=>a.status==="completed"),x=n.filter(a=>a.status!=="completed");return e.jsxs("div",{className:"safe-top pb-8",children:[e.jsxs("div",{className:"px-4 pt-4 pb-4 flex items-center gap-4 border-b",children:[e.jsx(A,{variant:"ghost",size:"icon",onClick:()=>l(-1),children:e.jsx(T,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl font-bold",children:t("vehicle.history")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.brand," ",r.model," â€¢ ",r.licensePlate]})]})]}),e.jsxs("div",{className:"px-4 pt-4 space-y-4",children:[e.jsxs(i,{children:[e.jsx(B,{className:"pb-2",children:e.jsxs(J,{className:"text-base flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),t("jobs.vehicleInfo")]})}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:t("vehicle.brand")}),e.jsx("p",{className:"font-medium",children:r.brand})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:t("vehicle.model")}),e.jsx("p",{className:"font-medium",children:r.model})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:t("vehicle.year")}),e.jsx("p",{className:"font-medium",children:r.year})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:t("vehicle.licensePlate")}),e.jsx("p",{className:"font-medium font-mono",children:r.licensePlate})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs(i,{className:"p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:n.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Jobs"})]}),e.jsxs(i,{className:"p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[hsl(var(--status-completed))]",children:m.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Completed"})]}),e.jsxs(i,{className:"p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-[hsl(var(--status-in-progress))]",children:x.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Active"})]})]}),x.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3",children:"Active Jobs"}),e.jsx("div",{className:"space-y-3",children:x.map(a=>e.jsx(u,{job:a,userLanguage:c,onClick:()=>l(`/jobs/${a.id}`)},a.id))})]}),m.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3",children:"Completed Jobs"}),e.jsx("div",{className:"space-y-3",children:m.map(a=>e.jsx(u,{job:a,userLanguage:c,onClick:()=>l(`/jobs/${a.id}`)},a.id))})]}),n.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:t("common.noData")})]})]})]})}function u({job:s,userLanguage:l,onClick:t}){const c=s.assignedMechanicId?L(s.assignedMechanicId):null;return e.jsx(i,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:t,children:e.jsxs(f,{className:"p-4",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold",children:new Date(s.createdAt).toLocaleDateString("en-GB")}),e.jsx(_,{status:s.status})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:S(s,l)})]})}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs",children:[e.jsx("span",{className:`font-medium uppercase priority-${s.priority}`,children:s.priority}),c&&e.jsx("span",{className:"text-muted-foreground",children:c.fullName})]}),s.completedAt&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-[hsl(var(--status-completed))]",children:[e.jsx(V,{className:"h-3 w-3"}),"Completed ",new Date(s.completedAt).toLocaleDateString("en-GB")]})]})})}export{R as default};
