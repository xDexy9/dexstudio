import{bB as s,bP as i,bC as d}from"./index-CNxWMcuV.js";const g=(a,t)=>a===0?0:Number(((t-a)/a*100).toFixed(2)),S=(a,t)=>Number((a*(1+t/100)).toFixed(2)),m=async()=>[...s.parts],l=async(a,t)=>{const c=i(),r=new Date().toISOString();return s.parts.push({id:c,totalUsageCount:0,createdAt:r,updatedAt:r,createdBy:t,updatedBy:t,...a}),d(),c},x=async(a,t,c)=>{const r=s.parts.findIndex(e=>e.id===a);r!==-1&&(s.parts[r]={...s.parts[r],...t,updatedAt:new Date().toISOString(),updatedBy:c},d())},o=async a=>{const t=s.parts.findIndex(c=>c.id===a);t!==-1&&(s.parts.splice(t,1),d())},P=async(a,t,c,r,e)=>{const n=s.parts.findIndex(f=>f.id===a);if(n===-1)return;const u=s.parts[n];s.parts[n]={...u,stockQuantity:u.stockQuantity+t,updatedAt:new Date().toISOString(),updatedBy:r};const y={id:i(),partId:a,partName:u.name,type:c,quantity:t,jobId:e==null?void 0:e.jobId,costPerUnit:e==null?void 0:e.costPerUnit,totalCost:e!=null&&e.costPerUnit?Math.abs(t)*e.costPerUnit:void 0,reason:e==null?void 0:e.reason,notes:e==null?void 0:e.notes,performedBy:r,performedAt:new Date().toISOString()};s.stockTransactions.push(y),d()},A=async()=>s.parts.filter(a=>a.isActive),U=async a=>s.parts.find(t=>t.partNumber===a&&t.isActive)||null,B=async(a,t,c)=>{for(const r of a)await P(r.partId,-r.quantity,"usage",c,{jobId:t,costPerUnit:r.costPerUnit,reason:`Used in job ${t}`})},I=async(a,t)=>l(a,t);export{I as a,U as b,P as c,B as d,m as e,S as f,A as g,g as h,o as i,x as u};
