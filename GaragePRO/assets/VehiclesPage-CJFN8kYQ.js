import{c as ne,u as ie,d as de,r as c,j as e,B as x,P as oe,e as b,i as w,N as d,_ as n,M as he,K as G,af as me,a2 as xe,ah as ue,av as pe,bp as je}from"./index-CNxWMcuV.js";import{C as ve}from"./car-brand-logo-BjPA7wLP.js";import{D as ge,a as fe,E as ye,b as Ne,c as E,d as be}from"./dropdown-menu-B4ssD23R.js";import{D as J,b as A,c as H,d as I,e as z,f as Y}from"./dialog-CIS6byhQ.js";import{S as g,a as f,b as y,c as N,d as j}from"./select-CbHlLrev.js";import{u as we}from"./use-toast-C9pXjDz0.js";import{F as Ce}from"./file-text-_cJWw5Fx.js";import{G as De}from"./gauge-BGmypo8-.js";import{L as Pe}from"./layout-grid-BWDaq3YL.js";import{S as Se}from"./search-vDLcJ1l5.js";import{F as Ve}from"./filter-BR7a_zVs.js";import{C as Te}from"./car-DWakAuoX.js";import{H as Fe}from"./history-n8JiAN2h.js";import{S as Le}from"./square-pen-wrU9Jooq.js";import{C as Me}from"./calendar-BxIrFUaJ.js";import{f as ke}from"./format-DSNd7y_7.js";import"./chevron-down-n_8xVDCk.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=ne("CarFront",[["path",{d:"m21 8-2 2-1.5-3.7A2 2 0 0 0 15.646 5H8.4a2 2 0 0 0-1.903 1.257L5 10 3 8",key:"1imjwt"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 14h.01",key:"7oqj8z"}],["rect",{width:"18",height:"8",x:"3",y:"10",rx:"2",key:"a7itu8"}],["path",{d:"M5 18v2",key:"ppbyun"}],["path",{d:"M19 18v2",key:"gy7782"}]]),K=["Renault","Peugeot","CitroÃ«n","Dacia","Volkswagen","BMW","Mercedes-Benz","Audi","Ford","Opel","Toyota","Honda","Nissan","Fiat","Seat","Skoda"];function Oe({vehicle:a,jobCount:C,onEdit:v,onDelete:D,onViewHistory:m,t:o}){return e.jsx(b,{className:"border-0 shadow-sm hover:shadow-md transition-all duration-300 group",children:e.jsxs(w,{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{brand:a.brand,size:"lg",className:"text-primary"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:[a.brand," ",a.model]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.year})]})]}),e.jsxs(ge,{children:[e.jsx(fe,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ye,{className:"h-4 w-4"})})}),e.jsxs(Ne,{align:"end",children:[e.jsxs(E,{onClick:m,children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),o("vehicles.viewHistory")]}),e.jsxs(E,{onClick:v,children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),o("common.edit")]}),e.jsx(be,{}),e.jsxs(E,{className:"text-destructive",onClick:D,children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),o("common.delete")]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/30",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:o("vehicles.licensePlate")}),e.jsx(G,{variant:"secondary",className:"font-mono",children:a.licensePlate})]}),a.vin&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:o("vehicles.vin")}),e.jsxs("span",{className:"font-mono text-xs",children:[a.vin.slice(0,11),"..."]})]}),a.color&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:o("vehicles.color")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border",style:{backgroundColor:a.color.toLowerCase()}}),e.jsx("span",{children:a.color})]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:o("vehicles.added").replace("{date}",ke(new Date(a.createdAt),"MM/yyyy"))})]}),e.jsx(G,{variant:C>0?"default":"secondary",className:"text-xs",children:o("vehicles.jobs").replace("{count}",C.toString())})]})]})})}function Ze(){const{t:a}=ie(),C=de(),{toast:v}=we(),D=[{value:"petrol",label:a("vehicles.petrol")},{value:"diesel",label:a("vehicles.diesel")},{value:"electric",label:a("vehicles.electric")},{value:"hybrid",label:a("vehicles.hybrid")},{value:"lpg",label:a("vehicles.lpg")},{value:"other",label:a("vehicles.other")}],[m,o]=c.useState(""),[P,U]=c.useState("all");c.useState("grid");const[_,S]=c.useState(!1),[Q,V]=c.useState(!1),[W,T]=c.useState(!1),[i,F]=c.useState(null),[X,k]=c.useState(0),[h,Z]=c.useState([]),[B,ee]=c.useState(new Map),[R,$]=c.useState(!0),[r,t]=c.useState({brand:"",model:"",year:new Date().getFullYear(),licensePlate:"",vin:"",color:"",fuelType:""});c.useEffect(()=>{(async()=>{try{$(!0);const l=await me();Z(l);const u=new Map;await Promise.all(l.map(async p=>{const O=await xe(p.id);u.set(p.id,O.length)})),ee(u)}catch(l){console.error("Error loading vehicles:",l)}finally{$(!1)}})()},[X]);const se=c.useMemo(()=>{const s=new Set(h.map(l=>l.brand));return Array.from(s).sort()},[h]),q=c.useMemo(()=>h.filter(s=>{const l=s.brand.toLowerCase().includes(m.toLowerCase())||s.model.toLowerCase().includes(m.toLowerCase())||s.licensePlate.toLowerCase().includes(m.toLowerCase())||s.vin&&s.vin.toLowerCase().includes(m.toLowerCase()),u=P==="all"||s.brand===P;return l&&u}),[h,m,P]),L=c.useMemo(()=>{const s=Array.from(B.values()).reduce((p,O)=>p+O,0),l=h.length>0?Math.round(s/h.length*10)/10:0,u=new Set(h.map(p=>p.brand)).size;return{total:h.length,totalJobs:s,avgJobsPerVehicle:l,brandsCount:u}},[h,B]),ae=async()=>{const s={brand:r.brand,model:r.model,year:r.year,licensePlate:r.licensePlate.toUpperCase()};r.vin&&(s.vin=r.vin),r.color&&(s.color=r.color),r.fuelType&&(s.fuelType=r.fuelType),await ue(s),S(!1),M(),k(l=>l+1),v({title:"Vehicle added",description:`${r.brand} ${r.model} has been added to the fleet.`})},le=async()=>{if(!i)return;const s={brand:r.brand,model:r.model,year:r.year,licensePlate:r.licensePlate.toUpperCase()};r.vin&&(s.vin=r.vin),r.color&&(s.color=r.color),r.fuelType&&(s.fuelType=r.fuelType),await pe(i.id,s),V(!1),F(null),M(),k(l=>l+1),v({title:"Vehicle updated",description:`${r.brand} ${r.model} has been updated.`})},re=()=>{i&&(je(i.id),T(!1),F(null),k(s=>s+1),v({title:"Vehicle deleted",description:"The vehicle has been removed from the fleet."}))},M=()=>{t({brand:"",model:"",year:new Date().getFullYear(),licensePlate:"",vin:"",color:"",fuelType:""})},te=s=>{F(s),t({brand:s.brand,model:s.model,year:s.year,licensePlate:s.licensePlate,vin:s.vin||"",color:s.color||"",fuelType:s.fuelType||""}),V(!0)},ce=s=>B.get(s)||0;return e.jsxs("div",{className:"space-y-8 pb-8",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:a("vehicles.title")}),e.jsx("p",{className:"text-muted-foreground",children:a("vehicles.subtitle")})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(x,{size:"sm",className:"h-9",onClick:()=>S(!0),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),a("vehicles.addVehicle")]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(b,{className:"border-0 shadow-sm",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Be,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:L.total}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("vehicles.totalVehicles")})]})]})})}),e.jsx(b,{className:"border-0 shadow-sm",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:L.totalJobs}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("customers.totalJobs")})]})]})})}),e.jsx(b,{className:"border-0 shadow-sm",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(De,{className:"h-5 w-5 text-emerald-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:L.avgJobsPerVehicle}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("vehicles.avgJobsPerVehicle")})]})]})})}),e.jsx(b,{className:"border-0 shadow-sm",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pe,{className:"h-5 w-5 text-violet-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:L.brandsCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("vehicles.brands")})]})]})})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(d,{placeholder:a("vehicles.searchPlaceholder"),className:"pl-10 h-10 bg-muted/30 border-0",value:m,onChange:s=>o(s.target.value)})]}),e.jsxs(g,{value:P,onValueChange:U,children:[e.jsxs(f,{className:"w-44 h-10 bg-muted/30 border-0",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2 text-muted-foreground"}),e.jsx(y,{placeholder:a("vehicles.filterByBrand")})]}),e.jsxs(N,{children:[e.jsx(j,{value:"all",children:a("vehicles.allBrands")}),se.map(s=>e.jsx(j,{value:s,children:s},s))]})]})]}),R&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:a("vehicles.loading")})}),!R&&e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-5",children:[q.map(s=>e.jsx(Oe,{vehicle:s,jobCount:ce(s.id),onEdit:()=>te(s),onDelete:()=>{F(s),T(!0)},onViewHistory:()=>C(`/vehicles/${s.id}/history`),t:a},s.id)),q.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(Te,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a("vehicles.noVehiclesFound")})]})]}),e.jsx(J,{open:_,onOpenChange:S,children:e.jsxs(A,{className:"sm:max-w-lg",children:[e.jsxs(H,{children:[e.jsx(I,{children:a("vehicles.addVehicle")}),e.jsx(z,{children:a("vehicles.addVehicleDialog")})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.brand")}),e.jsxs(g,{value:r.brand,onValueChange:s=>t(l=>({...l,brand:s})),children:[e.jsx(f,{children:e.jsx(y,{placeholder:a("vehicles.selectBrand")})}),e.jsx(N,{children:K.map(s=>e.jsx(j,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.model")}),e.jsx(d,{value:r.model,onChange:s=>t(l=>({...l,model:s.target.value})),placeholder:a("vehicles.modelPlaceholder")})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.year")}),e.jsx(d,{type:"number",value:r.year,onChange:s=>t(l=>({...l,year:parseInt(s.target.value)||new Date().getFullYear()})),min:1900,max:new Date().getFullYear()+1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.licensePlate")}),e.jsx(d,{value:r.licensePlate,onChange:s=>t(l=>({...l,licensePlate:s.target.value})),placeholder:a("vehicles.platePlaceholder"),className:"uppercase"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.vinOptional")}),e.jsx(d,{value:r.vin,onChange:s=>t(l=>({...l,vin:s.target.value})),placeholder:a("vehicles.vinPlaceholder"),maxLength:17})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.colorOptional")}),e.jsx(d,{value:r.color,onChange:s=>t(l=>({...l,color:s.target.value})),placeholder:a("vehicles.colorPlaceholder")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.fuelTypeOptional")}),e.jsxs(g,{value:r.fuelType,onValueChange:s=>t(l=>({...l,fuelType:s})),children:[e.jsx(f,{children:e.jsx(y,{placeholder:a("vehicles.selectFuelType")})}),e.jsx(N,{children:D.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs(Y,{children:[e.jsx(x,{variant:"outline",onClick:()=>{S(!1),M()},children:a("common.cancel")}),e.jsx(x,{onClick:ae,disabled:!r.brand||!r.model||!r.licensePlate,children:a("vehicles.addVehicle")})]})]})}),e.jsx(J,{open:Q,onOpenChange:V,children:e.jsxs(A,{className:"sm:max-w-lg",children:[e.jsxs(H,{children:[e.jsx(I,{children:a("vehicles.editVehicle")}),e.jsx(z,{children:a("vehicles.editVehicleDialog")})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.brand")}),e.jsxs(g,{value:r.brand,onValueChange:s=>t(l=>({...l,brand:s})),children:[e.jsx(f,{children:e.jsx(y,{})}),e.jsx(N,{children:K.map(s=>e.jsx(j,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.model")}),e.jsx(d,{value:r.model,onChange:s=>t(l=>({...l,model:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.year")}),e.jsx(d,{type:"number",value:r.year,onChange:s=>t(l=>({...l,year:parseInt(s.target.value)||new Date().getFullYear()}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.licensePlate")}),e.jsx(d,{value:r.licensePlate,onChange:s=>t(l=>({...l,licensePlate:s.target.value})),className:"uppercase"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.vin")}),e.jsx(d,{value:r.vin,onChange:s=>t(l=>({...l,vin:s.target.value})),maxLength:17})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.color")}),e.jsx(d,{value:r.color,onChange:s=>t(l=>({...l,color:s.target.value}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:a("vehicles.fuelType")}),e.jsxs(g,{value:r.fuelType,onValueChange:s=>t(l=>({...l,fuelType:s})),children:[e.jsx(f,{children:e.jsx(y,{placeholder:a("vehicles.selectFuelType")})}),e.jsx(N,{children:D.map(s=>e.jsx(j,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs(Y,{children:[e.jsx(x,{variant:"outline",onClick:()=>{V(!1),M()},children:a("common.cancel")}),e.jsx(x,{onClick:le,children:a("common.save")})]})]})}),e.jsx(J,{open:W,onOpenChange:T,children:e.jsxs(A,{className:"sm:max-w-md",children:[e.jsxs(H,{children:[e.jsx(I,{children:a("vehicles.deleteVehicle")}),e.jsx(z,{children:a("vehicles.deleteConfirm").replace("{brand}",(i==null?void 0:i.brand)||"").replace("{model}",(i==null?void 0:i.model)||"").replace("{plate}",(i==null?void 0:i.licensePlate)||"")})]}),e.jsxs(Y,{children:[e.jsx(x,{variant:"outline",onClick:()=>T(!1),children:a("common.cancel")}),e.jsx(x,{variant:"destructive",onClick:re,children:a("common.delete")})]})]})})]})}export{Ze as default};
