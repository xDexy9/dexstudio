import{c as P,o as J,u as W,r as m,s as x,j as e,B as N,e as h,f as u,h as p,bf as y,i as g,_ as t,N as o,M as X}from"./index-CNxWMcuV.js";import{g as Y,i as ee,s as ae,d as I,u as se}from"./companySettingsService-BheHf_-3.js";import{T as q}from"./textarea-D6buyuls.js";import{S as k,a as R,b as V,c as E,d as L}from"./select-CbHlLrev.js";import{T as le,a as re,b,c as C}from"./tabs-gg0ONG9Z.js";import{A,a as B}from"./alert-DkvkXxH8.js";import{S as M}from"./save-Ctp_DjlL.js";import{F as ne}from"./file-text-_cJWw5Fx.js";import{C as ie}from"./circle-check-big-a_8kXWWc.js";import"./chevron-down-n_8xVDCk.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=P("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=P("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=P("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=P("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function ve(){const{user:j}=J(),{t:a}=W(),w=m.useRef(null),Q=[{value:"EUR",label:"€ Euro (EUR)"},{value:"USD",label:"$ US Dollar (USD)"},{value:"GBP",label:"£ British Pound (GBP)"},{value:"CHF",label:"CHF Swiss Franc (CHF)"}],G=["France","Germany","United Kingdom","Spain","Italy","Portugal","Belgium","Netherlands","Switzerland","Luxembourg","United States","Canada","Other"],[O,F]=m.useState(!0),[f,D]=m.useState(!1),[S,T]=m.useState(!1),[c,K]=m.useState(null),[l,i]=m.useState({companyName:"",legalName:"",street:"",city:"",postalCode:"",country:"France",taxId:"",registrationNumber:"",phone:"",email:"",website:"",logoUrl:"",quotePrefix:"QTE",invoicePrefix:"INV",defaultTaxRate:20,currency:"EUR",defaultPaymentTermsDays:30,quoteValidityDays:30,termsAndConditions:"",invoiceFooter:""});m.useEffect(()=>{Z()},[j]);const Z=async()=>{var s,r,v,d;if(j)try{F(!0);let n=await Y();n||(n=await ee(j.id)),K(n),i({companyName:n.companyName||"",legalName:n.legalName||"",street:((s=n.address)==null?void 0:s.street)||"",city:((r=n.address)==null?void 0:r.city)||"",postalCode:((v=n.address)==null?void 0:v.postalCode)||"",country:((d=n.address)==null?void 0:d.country)||"France",taxId:n.taxId||"",registrationNumber:n.registrationNumber||"",phone:n.phone||"",email:n.email||"",website:n.website||"",logoUrl:n.logoUrl||"",quotePrefix:n.quotePrefix||"QTE",invoicePrefix:n.invoicePrefix||"INV",defaultTaxRate:n.defaultTaxRate||20,currency:n.currency||"EUR",defaultPaymentTermsDays:n.defaultPaymentTermsDays||30,quoteValidityDays:n.quoteValidityDays||30,termsAndConditions:n.termsAndConditions||"",invoiceFooter:n.invoiceFooter||""})}catch(n){console.error("Error loading settings:",n),x.error(a("company.loadFailed"))}finally{F(!1)}},U=async()=>{if(j)try{D(!0);const s={companyName:l.companyName,legalName:l.legalName||void 0,address:{street:l.street,city:l.city,postalCode:l.postalCode,country:l.country},taxId:l.taxId,registrationNumber:l.registrationNumber||void 0,phone:l.phone,email:l.email,website:l.website||void 0,logoUrl:l.logoUrl||void 0,quotePrefix:l.quotePrefix,invoicePrefix:l.invoicePrefix,nextQuoteNumber:(c==null?void 0:c.nextQuoteNumber)||1,nextInvoiceNumber:(c==null?void 0:c.nextInvoiceNumber)||1,defaultTaxRate:l.defaultTaxRate,currency:l.currency,defaultPaymentTermsDays:l.defaultPaymentTermsDays,quoteValidityDays:l.quoteValidityDays,termsAndConditions:l.termsAndConditions,invoiceFooter:l.invoiceFooter||void 0,updatedBy:j.id};await ae(s,j.id),x.success(a("company.saved"))}catch(s){console.error("Error saving settings:",s),x.error(a("company.saveFailed"))}finally{D(!1)}},_=async s=>{var v;const r=(v=s.target.files)==null?void 0:v[0];if(r)try{T(!0),l.logoUrl&&await I(l.logoUrl);const d=await se(r);i(n=>({...n,logoUrl:d})),x.success(a("company.logoUploaded"))}catch(d){console.error("Error uploading logo:",d),x.error(d.message||a("company.logoUploadFailed"))}finally{T(!1)}},$=async()=>{if(l.logoUrl)try{await I(l.logoUrl),i(s=>({...s,logoUrl:""})),x.success(a("company.logoDeleted"))}catch(s){console.error("Error deleting logo:",s),x.error(a("company.logoDeleteFailed"))}};return O?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(z,{className:"h-8 w-8 text-primary"}),a("company.title")]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:a("company.subtitle")})]}),e.jsxs(N,{onClick:U,disabled:f,children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),a(f?"company.saving":"company.saveSettings")]})]}),e.jsxs(le,{defaultValue:"business",className:"space-y-6",children:[e.jsxs(re,{className:"grid grid-cols-4 w-full max-w-2xl",children:[e.jsxs(b,{value:"business",className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:a("company.tabs.business")})]}),e.jsxs(b,{value:"branding",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:a("company.tabs.branding")})]}),e.jsxs(b,{value:"invoicing",className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:a("company.tabs.invoicing")})]}),e.jsxs(b,{value:"legal",className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:a("company.tabs.legal")})]})]}),e.jsxs(C,{value:"business",className:"space-y-6",children:[e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(p,{children:a("company.businessInfo")}),e.jsx(y,{children:a("company.businessInfoDesc")})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(t,{htmlFor:"companyName",children:[a("company.companyName")," *"]}),e.jsx(o,{id:"companyName",value:l.companyName,onChange:s=>i(r=>({...r,companyName:s.target.value})),placeholder:a("company.companyNamePlaceholder")})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"legalName",children:a("company.legalName")}),e.jsx(o,{id:"legalName",value:l.legalName,onChange:s=>i(r=>({...r,legalName:s.target.value})),placeholder:a("company.legalNamePlaceholder")})]})]}),e.jsxs("div",{children:[e.jsxs(t,{htmlFor:"street",children:[a("company.streetAddress")," *"]}),e.jsx(o,{id:"street",value:l.street,onChange:s=>i(r=>({...r,street:s.target.value})),placeholder:a("company.streetPlaceholder")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs(t,{htmlFor:"city",children:[a("company.city")," *"]}),e.jsx(o,{id:"city",value:l.city,onChange:s=>i(r=>({...r,city:s.target.value})),placeholder:a("company.cityPlaceholder")})]}),e.jsxs("div",{children:[e.jsxs(t,{htmlFor:"postalCode",children:[a("company.postalCode")," *"]}),e.jsx(o,{id:"postalCode",value:l.postalCode,onChange:s=>i(r=>({...r,postalCode:s.target.value})),placeholder:a("company.postalCodePlaceholder")})]}),e.jsxs("div",{children:[e.jsxs(t,{htmlFor:"country",children:[a("company.country")," *"]}),e.jsxs(k,{value:l.country,onValueChange:s=>i(r=>({...r,country:s})),children:[e.jsx(R,{children:e.jsx(V,{})}),e.jsx(E,{children:G.map(s=>e.jsx(L,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(t,{htmlFor:"taxId",children:[a("company.taxId")," *"]}),e.jsx(o,{id:"taxId",value:l.taxId,onChange:s=>i(r=>({...r,taxId:s.target.value})),placeholder:a("company.taxIdPlaceholder")})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"registrationNumber",children:a("company.registrationNumber")}),e.jsx(o,{id:"registrationNumber",value:l.registrationNumber,onChange:s=>i(r=>({...r,registrationNumber:s.target.value})),placeholder:a("company.registrationPlaceholder")})]})]})]})]}),e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(p,{children:a("company.contactInfo")}),e.jsx(y,{children:a("company.contactInfoDesc")})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(t,{htmlFor:"phone",children:[a("company.phone")," *"]}),e.jsx(o,{id:"phone",value:l.phone,onChange:s=>i(r=>({...r,phone:s.target.value})),placeholder:a("company.phonePlaceholder")})]}),e.jsxs("div",{children:[e.jsxs(t,{htmlFor:"email",children:[a("company.email")," *"]}),e.jsx(o,{id:"email",type:"email",value:l.email,onChange:s=>i(r=>({...r,email:s.target.value})),placeholder:a("company.emailPlaceholder")})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"website",children:a("company.website")}),e.jsx(o,{id:"website",value:l.website,onChange:s=>i(r=>({...r,website:s.target.value})),placeholder:a("company.websitePlaceholder")})]})]})]})]}),e.jsx(C,{value:"branding",className:"space-y-6",children:e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(p,{children:a("company.logo")}),e.jsx(y,{children:a("company.logoDesc")})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"w-48 h-24 border-2 border-dashed rounded-lg flex items-center justify-center bg-muted/30",children:l.logoUrl?e.jsx("img",{src:l.logoUrl,alt:"Company Logo",className:"max-w-full max-h-full object-contain"}):e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(H,{className:"h-8 w-8 mx-auto mb-1"}),e.jsx("p",{className:"text-xs",children:a("company.noLogoUploaded")})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{ref:w,type:"file",accept:"image/*",onChange:_,className:"hidden"}),e.jsxs(N,{variant:"outline",onClick:()=>{var s;return(s=w.current)==null?void 0:s.click()},disabled:S,children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),a(S?"company.uploading":"company.uploadLogo")]}),l.logoUrl&&e.jsxs(N,{variant:"destructive",size:"sm",onClick:$,children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),a("company.remove")]})]})]}),e.jsx(A,{children:e.jsx(B,{children:a("company.logoFormatsSupported")})})]})]})}),e.jsxs(C,{value:"invoicing",className:"space-y-6",children:[e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(p,{children:a("company.quoteInvoiceNumbering")}),e.jsx(y,{children:a("company.numberingDesc")})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"quotePrefix",children:a("company.quotePrefix")}),e.jsx(o,{id:"quotePrefix",value:l.quotePrefix,onChange:s=>i(r=>({...r,quotePrefix:s.target.value.toUpperCase()})),placeholder:a("company.quotePrefixPlaceholder"),maxLength:5}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[a("company.quotePreview"),": ",l.quotePrefix,"-2026-001"]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"invoicePrefix",children:a("company.invoicePrefix")}),e.jsx(o,{id:"invoicePrefix",value:l.invoicePrefix,onChange:s=>i(r=>({...r,invoicePrefix:s.target.value.toUpperCase()})),placeholder:a("company.invoicePrefixPlaceholder"),maxLength:5}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[a("company.quotePreview"),": ",l.invoicePrefix,"-2026-001"]})]})]}),e.jsxs(A,{children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx(B,{children:a("company.nextNumbers").replace("{quoteNum}",String((c==null?void 0:c.nextQuoteNumber)||1)).replace("{invoiceNum}",String((c==null?void 0:c.nextInvoiceNumber)||1))})]})]})]}),e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(p,{children:a("company.defaultSettings")}),e.jsx(y,{children:a("company.defaultSettingsDesc")})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"currency",children:a("company.currency")}),e.jsxs(k,{value:l.currency,onValueChange:s=>i(r=>({...r,currency:s})),children:[e.jsx(R,{children:e.jsx(V,{})}),e.jsx(E,{children:Q.map(s=>e.jsx(L,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"defaultTaxRate",children:a("company.defaultTaxRate")}),e.jsx(o,{id:"defaultTaxRate",type:"number",step:"0.1",min:"0",max:"100",value:l.defaultTaxRate,onChange:s=>i(r=>({...r,defaultTaxRate:Number(s.target.value)}))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"quoteValidityDays",children:a("company.quoteValidity")}),e.jsx(o,{id:"quoteValidityDays",type:"number",min:"1",max:"365",value:l.quoteValidityDays,onChange:s=>i(r=>({...r,quoteValidityDays:Number(s.target.value)}))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("company.quoteValidityDesc")})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"defaultPaymentTermsDays",children:a("company.paymentTerms")}),e.jsx(o,{id:"defaultPaymentTermsDays",type:"number",min:"0",max:"365",value:l.defaultPaymentTermsDays,onChange:s=>i(r=>({...r,defaultPaymentTermsDays:Number(s.target.value)}))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("company.paymentTermsDesc")})]})]})]})]})]}),e.jsxs(C,{value:"legal",className:"space-y-6",children:[e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(p,{children:a("company.termsAndConditions")}),e.jsx(y,{children:a("company.termsDesc")})]}),e.jsx(g,{children:e.jsx(q,{value:l.termsAndConditions,onChange:s=>i(r=>({...r,termsAndConditions:s.target.value})),placeholder:a("company.termsPlaceholder"),className:"min-h-[300px] font-mono text-sm"})})]}),e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(p,{children:a("company.invoiceFooter")}),e.jsx(y,{children:a("company.invoiceFooterDesc")})]}),e.jsx(g,{children:e.jsx(q,{value:l.invoiceFooter,onChange:s=>i(r=>({...r,invoiceFooter:s.target.value})),placeholder:a("company.invoiceFooterPlaceholder"),className:"min-h-[150px]"})})]})]})]}),e.jsx("div",{className:"fixed bottom-6 right-6",children:e.jsxs(N,{onClick:U,disabled:f,size:"lg",className:"shadow-lg",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),a(f?"company.saving":"company.saveSettings")]})})]})}export{ve as CompanySettingsPage};
